(  SELECT  CASE  WHEN  (SELECT (SELECT SUM(tpp.Kusy_zad * tpp.TAC_S / 3600.0)    FROM TabPrPostup tpp WITH(NOLOCK)    LEFT OUTER JOIN TabPrikaz tp WITH(NOLOCK) ON tp.ID = tpp.IDPrikaz    LEFT OUTER JOIN TabCPraco tcp WITH(NOLOCK) ON tpp.Pracoviste=tcp.ID    WHERE tp.IDPlan = tpl.ID AND tpp.IDOdchylkyDO IS NULL AND tcp.IDTabStrom = '200' AND tp.StavPrikazu <= 40)    -    (SELECT ISNULL(SUM(MZ.Sk_cas_H),0)    FROM TabPrikazMzdyAZmetky MZ WITH(NOLOCK)    LEFT OUTER JOIN TabPrikaz tp WITH(NOLOCK) ON tp.ID = MZ.IDPrikaz    LEFT OUTER JOIN TabPrPostup tpp WITH(NOLOCK) ON tpp.IDPrikaz = tp.ID    LEFT OUTER JOIN TabCPraco tcp WITH(NOLOCK) ON tpp.Pracoviste=tcp.ID    WHERE MZ.IDPrikaz=tpp.IDprikaz AND MZ.DokladPrPostup=tpp.Doklad AND MZ.AltPrPostup=tpp.Alt AND MZ.stav=1 AND tp.IDPlan = tpl.ID AND tpp.IDOdchylkyDO IS NULL AND tcp.IDTabStrom = '200' AND tp.StavPrikazu <= 40)  FROM TabPlan tpl  WHERE tpl.ID = TabPlan.ID) > 0  THEN  (SELECT (SELECT SUM(tpp.Kusy_zad * tpp.TAC_S / 3600.0)    FROM TabPrPostup tpp WITH(NOLOCK)    LEFT OUTER JOIN TabPrikaz tp WITH(NOLOCK) ON tp.ID = tpp.IDPrikaz    LEFT OUTER JOIN TabCPraco tcp WITH(NOLOCK) ON tpp.Pracoviste=tcp.ID    WHERE tp.IDPlan = tpl.ID AND tpp.IDOdchylkyDO IS NULL AND tcp.IDTabStrom = '200' AND tp.StavPrikazu <= 40)    -    (SELECT ISNULL(SUM(MZ.Sk_cas_H),0)    FROM TabPrikazMzdyAZmetky MZ WITH(NOLOCK)    LEFT OUTER JOIN TabPrikaz tp WITH(NOLOCK) ON tp.ID = MZ.IDPrikaz    LEFT OUTER JOIN TabPrPostup tpp WITH(NOLOCK) ON tpp.IDPrikaz = tp.ID    LEFT OUTER JOIN TabCPraco tcp WITH(NOLOCK) ON tpp.Pracoviste=tcp.ID    WHERE MZ.IDPrikaz=tpp.IDprikaz AND MZ.DokladPrPostup=tpp.Doklad AND MZ.AltPrPostup=tpp.Alt AND MZ.stav=1 AND tp.IDPlan = tpl.ID AND tpp.IDOdchylkyDO IS NULL AND tcp.IDTabStrom = '200' AND tp.StavPrikazu <= 40)  FROM TabPlan tpl  WHERE tpl.ID = TabPlan.ID)  ELSE 0  END  )  
