CAST(CASE   WHEN EXISTS (SELECT * FROM TabKmenZbozi KZ WITH(NOLOCK)  WHERE(/*(KZ.material=1)AND*/(KZ.ShodaId=1)) AND KZ.ID IN (SELECT TabKvazby.nizsi FROM TabKvazby WITH(NOLOCK)    LEFT OUTER JOIN TabCzmeny VKVazbyZmenaOdCZmeny WITH(NOLOCK) ON TabKvazby.ZmenaOd=VKVazbyZmenaOdCZmeny.ID    LEFT OUTER JOIN TabCzmeny VKVazbyZmenaDoCZmeny WITH(NOLOCK) ON TabKvazby.ZmenaDo=VKVazbyZmenaDoCZmeny.ID  WHERE  (((TabKvazby.IDZakazModif IS NOT NULL OR VKVazbyZmenaOdCZmeny.platnostTPV=1 AND VKVazbyZmenaOdCZmeny.datum<= GETDATE() AND (VKVazbyZmenaDoCZmeny.platnostTPV=0 OR TabKvazby.ZmenaDo IS NULL OR (VKVazbyZmenaDoCZmeny.platnostTPV=1 AND VKVazbyZmenaDoCZmeny.datum>GETDATE())) )))) AND KZ.ID=TabKmenZbozi.ID ) THEN 1   ELSE  0  END AS BIT)
