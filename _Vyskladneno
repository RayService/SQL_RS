CAST(CASE WHEN EXISTS(SELECT *   FROM TabDokladyZbozi DZ     LEFT OUTER JOIN GTabVysklVazba VV ON VV.IDDoklad=DZ.ID     LEFT OUTER JOIN TabPohybyZbozi PZ ON PZ.IDDoklad=DZ.ID       LEFT OUTER JOIN TabStavSkladu SS ON SS.ID = PZ.IDZboSklad       LEFT OUTER JOIN TabKmenZbozi KZ ON KZ.ID = SS.IDKmenZbozi     OUTER APPLY (SELECT Mnozstvi=SUM(Mnozstvi) FROM Gatema_SDScanData Pol           LEFT OUTER JOIN Gatema_SDDoklady Hla ON Hla.ID=Pol.IDDokladSD WHERE Pol.IDPohZbo_New=PZ.ID AND Hla.TypDokladu=1100) Term   WHERE VV.IDVyskladneni=hvw_Vyskladneni.ID AND (DZ.Realizovano=0 AND PZ.Mnozstvi>ISNULL(Term.Mnozstvi, 0) AND KZ.Sluzba = 0)) THEN 0 ELSE 1 END   AS BIT)
