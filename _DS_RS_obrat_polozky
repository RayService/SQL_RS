(  SELECT  CASE  WHEN  (SELECT (TP.mnozstvi * PZ.JCBezDaniKC)  FROM TabPlan TP WITH(NOLOCK)  JOIN TabPohybyZbozi PZ WITH(NOLOCK) ON TP.IDRezervace = PZ.ID  JOIN TabDokladyZbozi TD WITH(NOLOCK) ON TD.ID = PZ.IDDoklad  WHERE TP.ID = TabPlan.ID) IS NULL  THEN  (SELECT  SUM(tppp.Kusy_zad * tppp.TAC_S / 3600.0)*2300  FROM TabPlan tp WITH(NOLOCK)    LEFT OUTER JOIN TabPlanPrikaz tpp WITH(NOLOCK) ON tpp.IDPlan = tp.ID    LEFT OUTER JOIN TabPlanPrPostup tppp WITH(NOLOCK) ON tppp.IDPlanPrikaz = tpp.ID    LEFT OUTER JOIN TabCPraco tcp WITH(NOLOCK) ON tppp.Pracoviste=tcp.ID  WHERE (tcp.IDTabStrom = '200' OR tcp.IDTabStrom LIKE N'2002%') AND tp.ID = TabPlan.ID)  ELSE  (SELECT (TP.mnozstvi * PZ.JCBezDaniKC)  FROM TabPlan TP WITH(NOLOCK)  JOIN TabPohybyZbozi PZ WITH(NOLOCK) ON TP.IDRezervace = PZ.ID  JOIN TabDokladyZbozi TD WITH(NOLOCK) ON TD.ID = PZ.IDDoklad  WHERE TP.ID = TabPlan.ID)  END  )  
