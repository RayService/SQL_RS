(CASE WHEN  (CASE WHEN ((TabSaldoDenPreh.[Castka_Splatno] - TabSaldoDenPreh.[Castka_Uhrazeno] > TabSaldoDenPreh.[Castka_KR]  OR TabSaldoDenPreh.[DatumUhrazeno] IS NULL))  THEN (CASE WHEN (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.DatumDen) < 0)  THEN (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.DatumDen))  ELSE (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.DatumDen)) END)  ELSE (CASE WHEN (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.[DatumUhrazeno]) < 0)  THEN (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.[DatumUhrazeno]))  ELSE (DATEDIFF(DAY,TabSaldoDenPreh.[DatumSplatno],TabSaldoDenPreh.[DatumUhrazeno])) END) END)  BETWEEN 1 AND 30  THEN TabSaldoDenPreh.Saldo_Ucet ELSE 0 END)
