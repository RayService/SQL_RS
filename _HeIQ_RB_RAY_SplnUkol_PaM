CAST(CASE   WHEN (SELECT U.DatumDokonceni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) IS NOT NULL THEN 65408   WHEN (SELECT U.DatumDokonceni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) IS NULL AND (SELECT U.TerminSplneni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) BETWEEN GetDate() AND GetDate()+7   THEN 500984  WHEN (SELECT U.DatumDokonceni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) IS NULL AND  (SELECT U.TerminSplneni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) < GetDATE() AND  (SELECT U.DatZmeny_X FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) BETWEEN GetDate()-14 AND GetDate()+1 THEN 1  WHEN (SELECT U.DatumDokonceni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) IS NULL AND  (SELECT U.TerminSplneni FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) < GetDATE() AND  (SELECT U.DatZmeny_X FROM TabUkoly U WITH(NOLOCK) WHERE U.ID=TabUkoly.ID) <= GetDate()-14 THEN 2362475  ELSE   NULL  END AS INT)  
